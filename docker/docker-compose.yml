version: '2'

services:
  db:
    ports:
     - "3306:3306"
    volumes:
     - ./startupscripts:/docker-entrypoint-initdb.d
    environment:
     - MYSQL_ROOT_PASSWORD=pass
     - MYSQL_DATABASE=db
    image: mysql:latest
  mygo:
    build: ../src/
    depends_on:
     - "db"
    volumes:
     - "../src:/go/src"
     - ./db_volume:/var
    environment:
     GO_WORK_DIR: "/go/src/app"
    command: ["/var/test_db_connection.sh", "db:3306"]
    ports:
     - "3000:3000"
